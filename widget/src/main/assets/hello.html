<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-Control" content="no-store,no-cache">
    <meta name="Handheldfriendly" content="true">
    <meta name="viewport" content="width=100%; initial-scale=1.0; user-scalable=yes">
    <meta name="robots" content="all">
    <meta name="keywords" contect="doodle, mobile, doodlemobile, game, games">
    <meta name="description" content="Make People's Mobile Life More Connected Through Games.">

    <style type="text/css">
		div.border {
			border-style: groove;
			padding: 10px;
			margin: 10px
		}


    </style>

    <title>jsandroid_test</title>

    <script type="text/javascript" language="javascript">
		function getDeviceInfo() {
			XiaoTunYunJS.getDeviceInfo(function (res) {
				logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
			});
		}
		function goScan() {
			XiaoTunYunJS.goScan(2, function (res) {
				logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
			});
		}

		function getNetworkType() {
			XiaoTunYunJS.getNetworkType(function (res) {
				logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
				if (res == -1) {
					logInfo.innerHTML = logInfo.innerHTML + "<br>" + "网络不可用";
				} else if (res == 0) {
					logInfo.innerHTML = logInfo.innerHTML + "<br>" + "WIFI网络";
				} else if (res == 1) {
					logInfo.innerHTML = logInfo.innerHTML + "<br>" + "3G网络";
				} else if (res == 2) {
					logInfo.innerHTML = logInfo.innerHTML + "<br>" + "2G网络";
				} else if (res == 3) {
					logInfo.innerHTML = logInfo.innerHTML + "<br>" + "4G网络";f
				}
			});
		}

        var ids; // 选择照片的id集合

        function chooseImage() {
        	XiaoTunYunJS.chooseImage({
                sourceType: 0, //来源为相机
                count: 1, // 选择数量，默认1；0表示无限制
                cropMode: 0, //正方形裁剪
                success: function (res) {
                	logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
                    var imageIds = JSON.parse(res);  //照片的id列表数组
                    document.getElementById("chooseImage").innerHTML = imageIds.ids;
                    ids = imageIds.ids;
                },
                cancel: function () {
                    //用户取消了选择操作
                    logInfo.innerHTML = logInfo.innerHTML + "<br>" + 'image cancel';
                }
            });
        }

        function getDataUrl() {
        	XiaoTunYunJS.getDataUrl(ids[0], function (res) {
        		logInfo.innerHTML = logInfo.innerHTML + "<br>" + "image base64";
                var img = document.getElementById("img");  //假设页面上已有一个id为“img”的<img>元素
                img.src = "data:image/jpg;base64," + res;
            })
        }

        function previewImage() {
        	var params = {};
        	params.urls = ids;
        	params.index = 1;
        	/*XiaoTunYunJS.previewImage({ urls: ["d253ef29cd9f8c4501ebd40bfd32e562", "546f83d3e6577bf5213c476d9efea55a"], index: 1 }); */
        	XiaoTunYunJS.previewImage(params);
        }

        function uploadFile() {
        	var server = 'http://192.168.1.106:8080/test/servlet/UploadFile';
        	var para = {};
        	para.param1 = "param1";
        	para.param2 = "param2";
        	XiaoTunYunJS.uploadFile({
        		localIds: ids,
        		serverURL: server,
        		inputName: 'file',
        		stringParams:para,
        		header: '{"Content-type":"application/json;charset=utf-8"}',
        		status: function (progress) {
        			document.getElementById('upProgress').innerHTML = progress + "%";
        		},
        		success: function (res) {
        			logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
        		},
        		fail: function (res) {
        			logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
        		}
        	});
        }

        function downloadFile() {
        	XiaoTunYunJS.downloadFile({
        		urls: ['http://192.168.1.106:8080/test/servlet/DownloadFile?filename=89d3da6e-27be-4fa5-b7b8-53c987257228'],
        		status: function (progress) {
        			document.getElementById('downProgress').innerHTML = progress + "%";
        		},
        		success: function (res) {
        			logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
        		},
        		fail: function (res) {
        			logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
        		}
        	});
        }

        function startRecord() {
        	XiaoTunYunJS.startRecord(2, '', function (res) {
        		logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
        		audioId = res;
        		var id = document.getElementById('audioId').innerHTML = res;
        	});
        }

        function stopRecord() {
        	XiaoTunYunJS.stopRecord();
        }

        function playAudio() {
        	XiaoTunYunJS.playAudio(audioId, function (res) {
        		logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
        	});
        }

        function pauseAudio() {
        	XiaoTunYunJS.pauseAudio('200001');
        }
        function stopAudio() {
        	XiaoTunYunJS.stopAudio('200001');
        }

        function screenOrientation(t) {
        	XiaoTunYunJS.screenOrientation({type: t});
        }

        XiaoTunYunJSReady = function () {
        	logInfo = document.getElementById('loginfo');
        	logInfo.innerHTML = logInfo.innerHTML + "<br>" + "JS 注入成功";

        	XiaoTunYunJS.onResume(function (res) {
        		logInfo.innerHTML = logInfo.innerHTML + "<br>" + "onResume";
        	});

        	XiaoTunYunJS.onPause(function (res) {
        		logInfo.innerHTML = logInfo.innerHTML + "<br>" + "onPause";
        	});

        	XiaoTunYunJS.onNetworkStateChange(function (res) {
        		logInfo.innerHTML = logInfo.innerHTML + "<br>" + res;
        	});
        }


    </script>
</head>

<body>
<div class="border">
    <p>1、初始化成功回调</p>
    <p>2、监听程序前台</p>
    <p>3、监听监听后台</p>
    <p>4、监听网络状态</p>
    <input type="button" value="5、设备信息" onclick="getDeviceInfo()"/>
    <br>
    <br>
    <input type="button" value="6、二维码" onclick="goScan()"/>
    <br>
    <br>
    <input type="button" value="7、获取网络类型" onclick="getNetworkType()"/>
    <br>
    <br>
</div>
<div class="border">
    <div id="chooseImage" style="word-wrap:break-word">选择的照片的id</div>
    <input type="button" value="8、选择照片" onclick="chooseImage()"/>
    <br>
    <input type="button" value="9、获取照片Base64，显示照片" onclick="getDataUrl()"/>
    <br>
    <img id="img"/>
    <br>
    <input type="button" value="10、预览图片接口" onclick="previewImage()"/>
    <br>
    <input type="button" value="11、文件上传" onclick="uploadFile()"/>
    <div style="display:inline">上传进度：</div>
    <div id="upProgress" style="display:inline">0%</div>
    <br>
    <input type="button" value="12、文件下载" onclick="downloadFile()"/>
    <div style="display:inline">下载进度：</div>
    <div id="downProgress" style="display:inline">0%</div>
</div>
<div class="border">
    <div id="audioId">显示当前录音</div>
    <input type="button" value="13、开始录音" onclick="startRecord()"/>
    <input id="valueNum" type="text" value="波形："/>
    <br/>
    <input type="button" value="14、结束录音" onclick="stopRecord()"/>
    <br/>
    <input type="button" value="15、播放录音" onclick="playAudio()"/>
    <input type="button" value="16、暂停录音" onclick="pauseAudio()"/>
    <input type="button" value="17、停止播放" onclick="stopAudio()"/>
</div>

<div class="border">
    <input type="button" value="18、横屏" onclick="screenOrientation(1)"/>
    <input type="button" value="19、坚屏" onclick="screenOrientation(2)"/>
    <input type="button" value="20、支持旋转" onclick="screenOrientation(3)"/>
</div>
<div class="border" id="loginfo" style="word-wrap:break-word">日志：</div>
<br/>
</body>
</html>